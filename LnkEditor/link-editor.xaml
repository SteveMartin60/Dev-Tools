<Window x:Class="LnkEditor.link_editor"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="LNK File Editor"
        Height="550"
        Width="860"
        WindowStartupLocation="CenterScreen"
        Background="#FFF5F5F5">
    <Grid Margin="20">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition Height="Auto" />
            <RowDefinition Height="Auto" />
            <RowDefinition Height="Auto" />
            <RowDefinition Height="Auto" />
            <RowDefinition Height="Auto" />
            <RowDefinition Height="Auto" />
            <RowDefinition Height="*" />
            <RowDefinition Height="Auto" />
        </Grid.RowDefinitions>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="120" />
            <ColumnDefinition Width="*" />
            <ColumnDefinition Width="Auto" />
            <ColumnDefinition Width="Auto" />
        </Grid.ColumnDefinitions>

        <!-- Title -->
        <TextBlock Text="LNK File Editor"
                   FontSize="24"
                   FontWeight="Bold"
                   Foreground="#FF673AB7"
                   Grid.Row="0"
                   Grid.ColumnSpan="3"
                   HorizontalAlignment="Center"
                   Margin="0,0,0,30" />

        <!-- Shortcut File Path -->
        <TextBlock Text="Shortcut File:" VerticalAlignment="Center" Grid.Row="1" Grid.Column="0" />
        <TextBox x:Name="ShortcutPath" IsReadOnly="True" ToolTip="Select a shortcut file..." Grid.Row="1" Grid.Column="1" Margin="10,10,0,10" />
        <Button Content="Browse" Width="80" Height="30" Click="BrowseShortcut_Click" Grid.Row="1" Grid.Column="2" Margin="10,10,0,10" />

        <!-- Target Path -->
        <TextBlock Text="Target Path:" VerticalAlignment="Center" Grid.Row="2" Grid.Column="0" /> <TextBox x:Name="TargetPath" ToolTip="Enter target path (file or folder)..." Grid.Row="2" Grid.Column="1" Margin="10,10,0,10" />
        <Button Content="Browse" Width="80" Height="30" Click="BrowseTarget_Click" Grid.Row="2" Grid.Column="2" Margin="10,10,0,10" /> 
        
        <!-- Working Directory -->
        <TextBlock Text="Working Dir:" VerticalAlignment="Center" Grid.Row="3" Grid.Column="0" /> <TextBox x:Name="WorkingDirectory" ToolTip="Enter working directory..." Grid.Row="3" Grid.Column="1" Margin="10,10,0,10" />
        <Button Content="Browse" Width="80" Height="30" Click="BrowseWorkingDirectory_Click" Grid.Row="3" Grid.Column="2" Margin="10,10,0,10" />

        <!-- Arguments -->
        <TextBlock Text="Arguments:" VerticalAlignment="Center" Grid.Row="4" Grid.Column="0" />
        <TextBox x:Name="Arguments" ToolTip="Enter command-line arguments..." Grid.Row="4" Grid.Column="1" Margin="10,10,0,10" />

        <!-- Icon Location -->
        <TextBlock Text="Icon File:" VerticalAlignment="Center" Grid.Row="5" Grid.Column="0" />
        <TextBox x:Name="IconLocation" ToolTip="Select an icon file..." Grid.Row="5" Grid.Column="1" Margin="10,10,0,10" />
        <Button Content="Browse" Width="80" Height="30" Click="BrowseIcon_Click" Grid.Row="5" Grid.Column="2" Margin="10,10,0,10" />
        <Button Content="Pick Icon" Width="80" Height="30" Click="PickIconFromDll_Click" Grid.Row="5" Grid.Column="3" Margin="10,10,0,10" />

        <!-- Run state -->
        <TextBlock Text="Run:" VerticalAlignment="Center" Grid.Row="6" Grid.Column="0"/>
        <ComboBox x:Name="RunCombo" Width="120" SelectedIndex="1" Grid.Row="6" Grid.Column="1" Margin="10,10,0,10">
            <ComboBoxItem>Hidden</ComboBoxItem>
            <ComboBoxItem>Normal window</ComboBoxItem>
            <ComboBoxItem>Minimized</ComboBoxItem>
            <ComboBoxItem>Maximized</ComboBoxItem>
        </ComboBox>

        <!-- Hot-key -->
        <TextBlock Text="Hotkey:" VerticalAlignment="Center" Grid.Row="7" Grid.Column="0"/>
        <TextBox x:Name="Hotkey" ToolTip="Click here and press a key combination..."
         Grid.Row="7" Grid.Column="1" Grid.ColumnSpan="2" Margin="10,10,0,10"
         PreviewKeyDown="Hotkey_PreviewKeyDown"/>

        <!-- Save button moves down one row -->
        <Button Content="Save Changes" Grid.Row="8" Grid.ColumnSpan="4"
        HorizontalAlignment="Center" Width="150" Height="40"
        Margin="0,30,0,0" Click="SaveChanges_Click"/>
    </Grid>
</Window>